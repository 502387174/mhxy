<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>梦幻西游跑商助手 - 官方时间同步版</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Microsoft YaHei", "微软雅黑", sans-serif;
    }

    body {
      background: linear-gradient(135deg, #1a0a0f 0%, #2d1526 100%);
      color: #e0e0ff;
      min-height: 100vh;
      padding: 5px;
      font-size: 14px;
    }

    .container {
      max-width: 400px;
      margin: 0 auto;
      position: relative;
    }

    /* 顶部状态栏 */
    .status-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(5, 15, 30, 0.9);
      color: #a0c0ff;
      padding: 8px 15px;
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
    }

    .header {
      text-align: center;
      margin: 20px 0 10px 0;
      padding-top: 5px;
    }

    .header h1 {
      color: #f8d568;
      font-size: 20px;
      text-shadow: 0 0 10px rgba(248, 213, 104, 0.5);
      letter-spacing: 1px;
      margin-bottom: 3px;
      background: linear-gradient(to right, #f8d568, #ff9900);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .header p {
      color: #95c1ff;
      font-size: 12px;
    }

    .divider {
      height: 1px;
      background: linear-gradient(to right, transparent, #4d7dbd, transparent);
      margin: 20px 0;
    }

    /* 罗盘容器 */
    .compass-container {
      position: relative;
      width: 200px;
      height: 200px;
      margin: 0 auto;
      margin-bottom: 10px;
    }

    .compass-background {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(circle, #0c2b47 0%, #061220 100%);
      border: 3px solid #2a5f96;
      box-shadow: 0 0 20px rgba(42, 95, 150, 0.7);
      position: relative;
      overflow: hidden;
    }

    .compass-hour {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      transform-origin: 0 0;
    }

    .compass-hour-line {
      position: absolute;
      top: 0;
      left: 50%;
      width: 2px;
      height: 20px;
      background: linear-gradient(to bottom, rgba(74, 143, 214, 0.6), transparent);
      transform-origin: center 150px;
    }

    .compass-hour-text {
      position: absolute;
      color: #a0c0ff;
      font-size: 14px;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      text-shadow: 0 0 5px rgba(74, 143, 214, 0.8);
    }

    .current-hour-mark {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%) translateY(-10px);
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #ff3366;
      box-shadow: 0 0 15px rgba(255, 51, 102, 0.7);
      z-index: 10;
    }

    .current-hour-dot {
      position: absolute;
      top: 0;
      left: 50%;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #fff;
      transform: translateX(-50%) translateY(25px);
    }

    .refresh-hint {
      position: absolute;
      top: 30px;
      right: 30px;
      color: #ff9900;
      font-weight: bold;
      font-size: 20px;
    }

    /* 倒计时区域 */
    .countdown-box {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 30, 50, 0.7);
      border: 2px solid #2a5f96;
      border-radius: 8px;
      padding: 10px 15px;
      text-align: center;
      width: 150px;
      z-index: 5;
    }

    .countdown-title {
      color: #66ffff;
      font-size: 12px;
      margin-bottom: 3px;
    }

    .countdown-time {
      font-size: 18px;
      font-weight: bold;
      color: #66ffff;
      margin: 3px 0;
      text-shadow: 0 0 8px rgba(102, 255, 255, 0.6);
    }

    .cancel-alert-btn {
      background: linear-gradient(to bottom, #ff5555, #cc0000);
      color: white;
      border: none;
      border-radius: 20px;
      padding: 8px 20px;
      margin-top: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 3px 5px rgba(0, 0, 0, 0.3);
    }

    .cancel-alert-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 8px rgba(0, 0, 0, 0.4);
    }

    /* 操作区 */
    .operation-panel {
      background: rgba(25, 50, 80, 0.6);
      border: 1px solid #3a6390;
      border-radius: 8px;
      padding: 10px;
      margin: 10px auto;
      max-width: 350px;
      text-align: center;
    }

    .operation-text {
      color: #c0d0ff;
      margin-bottom: 8px;
      font-size: 12px;
    }

    .incense-btn {
      background: linear-gradient(to bottom, #ff6666, #cc3333);
      color: white;
      font-size: 14px;
      font-weight: bold;
      border: none;
      border-radius: 20px;
      padding: 8px 25px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    }

    .incense-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 7px 20px rgba(0, 0, 0, 0.4);
    }

    .incense-btn:active {
      transform: translateY(1px);
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    }

         /* 商品价格区域 */
     .prices-header {
       display: flex;
       align-items: center;
       justify-content: space-between;
       margin: 15px 0 10px;
       padding-bottom: 5px;
       border-bottom: 2px solid #3a6390;
     }

     /* 城市筛选按钮 */
     .city-filter {
       display: flex;
       justify-content: center;
       gap: 8px;
       margin: 10px 0;
       flex-wrap: wrap;
     }

     .city-filter-btn {
       background: linear-gradient(to bottom, #4d7dbd, #3a6390);
       color: white;
       border: none;
       border-radius: 15px;
       padding: 6px 12px;
       font-size: 12px;
       cursor: pointer;
       transition: all 0.3s;
       opacity: 0.7;
     }

     .city-filter-btn:hover {
       opacity: 1;
       transform: translateY(-1px);
       box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
     }

     .city-filter-btn.active {
       background: linear-gradient(to bottom, #66ccff, #4d7dbd);
       opacity: 1;
       transform: scale(1.05);
     }

     .city-card.hidden {
       display: none;
     }

    .prices-header h2 {
      color: #ffcc66;
      font-size: 16px;
    }

    .price-update {
      color: #66ccff;
      font-size: 11px;
    }

    .current-hour {
      color: #ff9900;
      font-weight: bold;
    }

    .prices-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 8px;
      margin-bottom: 15px;
    }

         .city-card {
       background: rgba(20, 40, 70, 0.6);
       border: 1px solid #3a6390;
       border-radius: 8px;
       padding: 15px 10px 10px 10px;
       position: relative;
       overflow: hidden;
     }

         .city-card::after {
       content: '';
       position: absolute;
       top: 0;
       left: 0;
       border-width: 0 0 30px 30px;
       border-style: solid;
       border-color: transparent transparent #2a5f96 transparent;
     }

         .city-card .city-name {
       position: absolute;
       top: 0;
       left: 0;
       background: linear-gradient(135deg, #2a5f96, #1e4a7a);
       color: white;
       font-weight: bold;
       padding: 4px 12px;
       font-size: 12px;
       border-bottom-right-radius: 8px;
       box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
       z-index: 2;
     }

         .price-item {
       display: flex;
       justify-content: space-between;
       padding: 8px 0;
       border-bottom: 1px dashed #304f70;
       font-size: 12px;
       margin-top: 5px;
     }

    .price-item:last-child {
      border-bottom: none;
    }

    .item-name {
      color: #b0d0ff;
    }

    .price-value {
      color: #ffd700;
      font-weight: bold;
    }

    .price-hint {
      font-size: 12px;
      color: #a0b0d0;
      margin-left: 5px;
    }

    /* 推荐路线区域 */
    .recommendations {
      background: rgba(20, 40, 70, 0.8);
      border: 1px solid #3a6390;
      border-radius: 8px;
      padding: 15px;
      margin-top: 10px;
    }

    .recommendations h2 {
      color: #66ccff;
      margin-bottom: 10px;
      font-size: 16px;
      text-align: center;
    }

    .recommendation {
      background: rgba(30, 60, 100, 0.5);
      border-left: 4px solid #66ccff;
      border-radius: 0 8px 8px 0;
      padding: 10px;
      margin-bottom: 10px;
    }

    .route-title {
      color: #ffcc66;
      font-weight: bold;
      font-size: 14px;
      margin-bottom: 5px;
    }

    .route-steps {
      color: #c0d8ff;
      line-height: 1.4;
      font-size: 12px;
    }

    .route-highlight {
      color: #ff9900;
      font-weight: bold;
    }

    .current-time {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(10, 30, 50, 0.8);
      padding: 8px 15px;
      border-radius: 15px;
      font-size: 14px;
      border: 1px solid #3a6390;
      color: #a0c0ff;
    }

    .compact-toggle {
      position: fixed;
      top: 10px;
      left: 10px;
      background: rgba(10, 30, 50, 0.8);
      padding: 8px 12px;
      border-radius: 15px;
      font-size: 16px;
      border: 1px solid #3a6390;
      color: #a0c0ff;
      cursor: pointer;
      z-index: 1000;
      transition: all 0.3s;
    }

    /* 交易记录功能 */
    .trade-record {
      position: fixed;
      top: 50px;
      right: 10px;
      background: rgba(10, 30, 50, 0.95);
      border: 1px solid #3a6390;
      border-radius: 10px;
      padding: 12px;
      width: 220px;
      z-index: 999;
      display: none;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
    }

    .trade-record.show {
      display: block;
    }

    .trade-record h3 {
      color: #ffcc66;
      font-size: 14px;
      margin-bottom: 10px;
      text-align: center;
      border-bottom: 1px solid #3a6390;
      padding-bottom: 5px;
    }

    .trade-item {
      background: rgba(30, 60, 100, 0.6);
      border: 1px solid #4d7dbd;
      border-radius: 6px;
      padding: 8px;
      margin-bottom: 6px;
      font-size: 12px;
      position: relative;
    }

    .trade-item .item-info {
      color: #b0d0ff;
      margin-bottom: 3px;
      font-weight: bold;
    }

    .trade-item .price-info {
      color: #ffd700;
      font-weight: bold;
      font-size: 13px;
    }

    .trade-item .time-info {
      color: #a0b0d0;
      font-size: 10px;
      margin-top: 3px;
    }

    .trade-actions {
      display: flex;
      gap: 6px;
      margin-top: 10px;
    }

    .trade-btn {
      background: linear-gradient(to bottom, #4CAF50, #45a049);
      color: white;
      border: none;
      border-radius: 15px;
      padding: 6px 12px;
      font-size: 11px;
      cursor: pointer;
      flex: 1;
      transition: all 0.3s;
    }

    .trade-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }

    .trade-btn.clear {
      background: linear-gradient(to bottom, #ff6666, #cc3333);
    }



    .trade-toggle {
      position: fixed;
      top: 50px;
      right: 10px;
      background: rgba(10, 30, 50, 0.8);
      padding: 8px 12px;
      border-radius: 15px;
      font-size: 16px;
      border: 1px solid #3a6390;
      color: #a0c0ff;
      cursor: pointer;
      z-index: 1000;
      transition: all 0.3s;
    }

    .trade-toggle:hover {
      background: rgba(20, 50, 80, 0.9);
      transform: scale(1.1);
    }

    .trade-toggle.active {
      background: rgba(76, 175, 80, 0.8);
      color: white;
    }

    /* 商品记录按钮 */
    .record-btn {
      background: linear-gradient(to bottom, #4CAF50, #45a049);
      color: white;
      border: none;
      border-radius: 12px;
      padding: 2px 6px;
      font-size: 10px;
      cursor: pointer;
      margin-left: 5px;
      transition: all 0.3s;
      opacity: 0.8;
    }

    .record-btn:hover {
      opacity: 1;
      transform: scale(1.1);
    }

    .record-btn.recorded {
      background: linear-gradient(to bottom, #ff6666, #cc3333);
    }

    .price-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 5px 0;
      border-bottom: 1px dashed #304f70;
      font-size: 12px;
    }

    .compact-toggle:hover {
      background: rgba(20, 50, 80, 0.9);
      transform: scale(1.1);
    }

    .compact-mode .operation-panel,
    .compact-mode .recommendations {
      display: none;
    }

    .compact-mode .prices-container {
      grid-template-columns: repeat(2, 1fr);
    }

    .compact-mode .trade-record {
      top: 80px;
      right: 10px;
    }

    .quick-route-tip {
      background: rgba(255, 153, 0, 0.1);
      border: 1px solid #ff9900;
      border-radius: 8px;
      padding: 8px;
      margin: 10px 0;
      font-size: 12px;
      color: #ffcc66;
      display: none;
    }

    .compact-mode .quick-route-tip {
      display: block;
    }

    /* 响应式设计 */
    @media (max-width: 768px) {
      .compass-container {
        width: 180px;
        height: 180px;
      }

      .compass-hour-text {
        font-size: 12px;
        top: 15px;
      }

      .countdown-box {
        width: 140px;
        padding: 8px 12px;
      }

      .countdown-time {
        font-size: 16px;
      }

      .prices-container {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 480px) {
      .header h1 {
        font-size: 18px;
      }

      .compass-container {
        width: 160px;
        height: 160px;
      }

      .refresh-hint {
        font-size: 16px;
        top: 15px;
        right: 15px;
      }

      .operation-panel {
        padding: 10px;
      }

      .prices-container {
        grid-template-columns: 1fr;
      }

      .container {
        max-width: 350px;
      }
    }

    /* 路线选择按钮样式 */
    .route-selector button {
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .route-selector button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    .route-selector button:active {
      transform: translateY(0);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
  </style>
</head>
<body>
<div class="current-time">09:18 56A 5G 47</div>
<div class="compact-toggle" onclick="toggleCompact()">📱</div>
<div class="trade-toggle" onclick="toggleTradeRecord()">📝</div>

   <!-- 交易记录面板 -->
  <div class="trade-record" id="tradeRecord">
    <h3>📋 交易记录</h3>
    <div id="tradeItems"></div>
    <div class="trade-actions">
      <button class="trade-btn clear" onclick="clearAllTrades()">一键清空</button>
    </div>
  </div>

<div class="container">
  <div class="header">
    <h1>《梦幻西游》电脑版跑商助手</h1>
    <p>时辰刷新提醒 · 商人物品价格 · 跑商推荐路线</p>
  </div>

  <div class="divider"></div>

  <!-- 罗盘区域 -->
  <div class="compass-container">
    <div class="compass-background">
      <!-- 时辰标记 -->
      <div class="compass-hour" style="transform: rotate(0deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">子</div>
      </div>
      <div class="compass-hour" style="transform: rotate(30deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">丑</div>
      </div>
      <div class="compass-hour" style="transform: rotate(60deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">寅</div>
      </div>
      <div class="compass-hour" style="transform: rotate(90deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">卯</div>
      </div>
      <div class="compass-hour" style="transform: rotate(120deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">辰</div>
      </div>
      <div class="compass-hour" style="transform: rotate(150deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">巳</div>
      </div>
      <div class="compass-hour" style="transform: rotate(180deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">午</div>
      </div>
      <div class="compass-hour" style="transform: rotate(210deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">未</div>
      </div>
      <div class="compass-hour" style="transform: rotate(240deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">申</div>
      </div>
      <div class="compass-hour" style="transform: rotate(270deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">酉</div>
      </div>
      <div class="compass-hour" style="transform: rotate(300deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">戌</div>
      </div>
      <div class="compass-hour" style="transform: rotate(330deg);">
        <div class="compass-hour-line"></div>
        <div class="compass-hour-text">亥</div>
      </div>

      <div class="current-hour-mark"></div> 
        <div class="current-hour-dot"></div>
        <div class="refresh-hint">刷</div>

      <!-- 倒计时区域 -->
      <div class="countdown-box">
        <div class="countdown-title">离下一个时辰还有</div>
        <div class="countdown-time" id="hour-countdown">88秒</div>
        <div class="countdown-title">距离下次刷价还有</div>
        <div class="countdown-time" id="price-countdown">88秒</div>
        <button class="cancel-alert-btn">取消提醒</button>
      </div>
    </div>
  </div>

  <div class="divider"></div>

  <!-- 操作区域 -->
  <div class="operation-panel">
    <p class="operation-text">点击开启按钮，手机将军令将会在30分钟后提醒你</p>
    <button class="incense-btn">开启摄妖香提醒</button>
  </div>

     <!-- 价格表区域 -->
   <div class="prices-header">
     <h2>商人物品价格</h2>
     <div class="price-update">当前时辰：<span class="current-hour" id="current-hour-display">未时</span> | 刷价倒计时：<span id="price-refresh">88</span>秒</div>
   </div>

   <!-- 城市筛选按钮 -->
   <div class="city-filter">
     <button class="city-filter-btn active" onclick="filterCity('all')">全部城市</button>
     <button class="city-filter-btn" onclick="filterCity('地府')">地府</button>
     <button class="city-filter-btn" onclick="filterCity('长安')">长安</button>
     <button class="city-filter-btn" onclick="filterCity('傲来')">傲来</button>
     <button class="city-filter-btn" onclick="filterCity('长寿')">长寿</button>
     <button class="city-filter-btn" onclick="filterCity('北俱')">北俱</button>
   </div>

     <!-- 快速路线提示 -->
   <div class="quick-route-tip">
     <strong>💡 快速路线：</strong>地府纸钱→长安棉布→地府首饰→长安扇子<br>
           <small>快捷键：Ctrl+1(紧凑模式) Ctrl+2/3/4(路线切换) Ctrl+5-0(城市筛选) Ctrl+T(交易记录) | 点击商品后的"记录"按钮输入真实价格</small>
   </div>

     <div class="prices-container">
          <!-- 地府 -->
      <div class="city-card" data-city="地府">
       <div class="city-name">地府</div>
       <div class="price-item">
         <span class="item-name">纸钱</span>
         <span><span class="price-value">3000</span><span class="price-hint">↓</span><button class="record-btn" onclick="recordItem('纸钱', 3000, '地府')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">夜明珠</span>
         <span><span class="price-value">8000</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('夜明珠', 8000, '地府')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">首饰</span>
         <span><span class="price-value">4300</span><span class="price-hint">↓</span><button class="record-btn" onclick="recordItem('首饰', 4300, '地府')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">珍珠</span>
         <span><span class="price-value">5500</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('珍珠', 5500, '地府')">记录</button></span>
       </div>
       <div class="price-item" style="border-top: 2px solid #4d7dbd; margin-top: 5px; padding-top: 5px;">
         <span class="item-name" style="color: #66ccff; font-size: 11px;">推荐</span>
         <span style="color: #66ccff; font-size: 11px;">纸钱、首饰</span>
       </div>
     </div>

                   <!-- 长安 -->
      <div class="city-card" data-city="长安">
       <div class="city-name">长安</div>
       <div class="price-item">
         <span class="item-name">棉布</span>
         <span><span class="price-value">3500</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('棉布', 3500, '长安')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">佛珠</span>
         <span><span class="price-value">7000</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('佛珠', 7000, '长安')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">扇子</span>
         <span><span class="price-value">3800</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('扇子', 3800, '长安')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">武器</span>
         <span><span class="price-value">4000</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('武器', 4000, '长安')">记录</button></span>
       </div>
       <div class="price-item" style="border-top: 2px solid #4d7dbd; margin-top: 5px; padding-top: 5px;">
         <span class="item-name" style="color: #66ccff; font-size: 11px;">推荐</span>
         <span style="color: #66ccff; font-size: 11px;">棉布、扇子、佛珠</span>
       </div>
     </div>

                   <!-- 傲来 -->
      <div class="city-card" data-city="傲来">
       <div class="city-name">傲来</div>
       <div class="price-item">
         <span class="item-name">帽子</span>
         <span><span class="price-value">3500</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('帽子', 3500, '傲来')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">商品盐</span>
         <span><span class="price-value">5500</span><span class="price-hint">↓</span><button class="record-btn" onclick="recordItem('商品盐', 5500, '傲来')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">蜡烛</span>
         <span><span class="price-value">2000</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('蜡烛', 2000, '傲来')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">商品酒</span>
         <span><span class="price-value">4000</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('商品酒', 4000, '傲来')">记录</button></span>
       </div>
       <div class="price-item" style="border-top: 2px solid #4d7dbd; margin-top: 5px; padding-top: 5px;">
         <span class="item-name" style="color: #66ccff; font-size: 11px;">推荐</span>
         <span style="color: #66ccff; font-size: 11px;">帽子、蜡烛、商品盐</span>
       </div>
     </div>

                   <!-- 长寿 -->
      <div class="city-card" data-city="长寿">
       <div class="city-name">长寿</div>
       <div class="price-item">
         <span class="item-name">木材</span>
         <span><span class="price-value">4400</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('木材', 4400, '长寿')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">鹿茸</span>
         <span><span class="price-value">7500</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('鹿茸', 7500, '长寿')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">面粉</span>
         <span><span class="price-value">3000</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('面粉', 3000, '长寿')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">商品符</span>
         <span><span class="price-value">5300</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('商品符', 5300, '长寿')">记录</button></span>
       </div>
       <div class="price-item" style="border-top: 2px solid #4d7dbd; margin-top: 5px; padding-top: 5px;">
         <span class="item-name" style="color: #66ccff; font-size: 11px;">推荐</span>
         <span style="color: #66ccff; font-size: 11px;">木材、鹿茸、商品符</span>
       </div>
     </div>

                   <!-- 北俱 -->
      <div class="city-card" data-city="北俱">
       <div class="city-name">北俱</div>
       <div class="price-item">
         <span class="item-name">衣甲</span>
         <span><span class="price-value">2700</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('衣甲', 2700, '北俱')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">人参</span>
         <span><span class="price-value">7500</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('人参', 7500, '北俱')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">铃铛</span>
         <span><span class="price-value">4300</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('铃铛', 4300, '北俱')">记录</button></span>
       </div>
       <div class="price-item">
         <span class="item-name">商品油</span>
         <span><span class="price-value">4000</span><span class="price-hint">~</span><button class="record-btn" onclick="recordItem('商品油', 4000, '北俱')">记录</button></span>
       </div>
       <div class="price-item" style="border-top: 2px solid #4d7dbd; margin-top: 5px; padding-top: 5px;">
         <span class="item-name" style="color: #66ccff; font-size: 11px;">推荐</span>
         <span style="color: #66ccff; font-size: 11px;">衣甲、人参、铃铛</span>
       </div>
     </div>
  </div>

  <!-- 推荐路线区域 -->
  <div class="recommendations">
    <h2>跑商推荐路线</h2>
    
    <!-- 快速路线选择 -->
    <div class="route-selector" style="background: rgba(30, 60, 100, 0.5); border-radius: 8px; padding: 15px; margin-bottom: 20px; text-align: center;">
      <div style="color: #66ccff; font-size: 16px; margin-bottom: 10px;">🎯 快速路线选择</div>
      <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
        <button onclick="showRoute('newbie')" style="background: linear-gradient(to bottom, #4CAF50, #45a049); color: white; border: none; border-radius: 20px; padding: 8px 16px; cursor: pointer; font-size: 14px;">新手路线</button>
        <button onclick="showRoute('intermediate')" style="background: linear-gradient(to bottom, #2196F3, #1976D2); color: white; border: none; border-radius: 20px; padding: 8px 16px; cursor: pointer; font-size: 14px;">进阶路线</button>
        <button onclick="showRoute('advanced')" style="background: linear-gradient(to bottom, #FF9800, #F57C00); color: white; border: none; border-radius: 20px; padding: 8px 16px; cursor: pointer; font-size: 14px;">高级路线</button>
        <button onclick="showRoute('all')" style="background: linear-gradient(to bottom, #9C27B0, #7B1FA2); color: white; border: none; border-radius: 20px; padding: 8px 16px; cursor: pointer; font-size: 14px;">显示全部</button>
      </div>
    </div>

    <div class="recommendation" data-route-type="newbie">
      <div class="route-title">新手推荐：地府 - 长安线（稳定收益）</div>
      <div class="route-steps">
        1. 在地府购买<span class="route-highlight">纸钱(3000以下)</span>或<span class="route-highlight">首饰(4300以下)</span><br>
        2. 前往长安城出售给商人<br>
        3. 在长安购买<span class="route-highlight">棉布(3500左右)</span>或<span class="route-highlight">扇子(3800左右)</span><br>
        4. 返回地府出售，完成一次循环<br>
        <span style="color: #66ccff; font-size: 14px;">💡 适合新手，路线简单，风险较低</span>
      </div>
    </div>

    <div class="recommendation" data-route-type="intermediate">
      <div class="route-title">进阶路线：长安 - 傲来线（中等收益）</div>
      <div class="route-steps">
        1. 在长安购买<span class="route-highlight">武器(4000左右)</span>或<span class="route-highlight">佛珠(7000左右)</span><br>
        2. 前往傲来国出售给商人<br>
        3. 在傲来购买<span class="route-highlight">帽子(3500左右)</span>或<span class="route-highlight">蜡烛(2000左右)</span><br>
        4. 返回长安出售，完成一次循环<br>
        <span style="color: #66ccff; font-size: 14px;">💡 收益稳定，适合有一定经验的玩家</span>
      </div>
    </div>

    <div class="recommendation" data-route-type="advanced">
      <div class="route-title">高效路线：傲来 - 长寿线（高收益）</div>
      <div class="route-steps">
        1. 在傲来购买<span class="route-highlight">商品酒(4000左右)</span>或<span class="route-highlight">商品盐(5500以下)</span><br>
        2. 前往长寿村出售给商人<br>
        3. 在长寿购买<span class="route-highlight">木材(4400左右)</span>或<span class="route-highlight">鹿茸(7500左右)</span><br>
        4. 返回傲来出售，完成一次循环<br>
        <span style="color: #66ccff; font-size: 14px;">💡 收益较高，但需要关注价格波动</span>
      </div>
    </div>

    <div class="recommendation" data-route-type="advanced">
      <div class="route-title">高级路线：长安 - 北俱线（最高收益）</div>
      <div class="route-steps">
        1. 在长安购买<span class="route-highlight">佛珠(7000左右)</span>或<span class="route-highlight">武器(4000左右)</span><br>
        2. 前往北俱芦洲出售给商人<br>
        3. 在北俱购买<span class="route-highlight">衣甲(2700左右)</span>或<span class="route-highlight">人参(7500左右)</span><br>
        4. 返回长安出售，完成一次循环<br>
        <span style="color: #66ccff; font-size: 14px;">💡 收益最高，但距离较远，适合高级玩家</span>
      </div>
    </div>

    <div class="recommendation" data-route-type="intermediate">
      <div class="route-title">三城循环：地府 - 长安 - 傲来线（综合收益）</div>
      <div class="route-steps">
        1. 在地府购买<span class="route-highlight">纸钱(3000以下)</span>或<span class="route-highlight">夜明珠(8000左右)</span><br>
        2. 前往长安城出售给商人<br>
        3. 在长安购买<span class="route-highlight">棉布(3500左右)</span>或<span class="route-highlight">扇子(3800左右)</span><br>
        4. 前往傲来国出售给商人<br>
        5. 在傲来购买<span class="route-highlight">帽子(3500左右)</span>或<span class="route-highlight">蜡烛(2000左右)</span><br>
        6. 返回地府出售，完成一次循环<br>
        <span style="color: #66ccff; font-size: 14px;">💡 综合收益好，适合有耐心的玩家</span>
      </div>
    </div>

    <div class="recommendation" data-route-type="tips" style="background: rgba(255, 102, 102, 0.1); border-left-color: #ff6666;">
      <div class="route-title" style="color: #ff6666;">⚠️ 跑商注意事项</div>
      <div class="route-steps">
        • 每次跑商前先查看当前价格，选择最合适的商品<br>
        • 注意时辰变化，价格每10分钟刷新一次<br>
        • 建议携带摄妖香，避免遇怪浪费时间<br>
        • 高级路线收益高但风险也大，新手建议从简单路线开始<br>
        • 遇到价格异常时，可以等待下一个时辰再跑商
      </div>
    </div>
  </div>
</div>

<script>
  // 时辰名称数组
  const hourNames = ["子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥"];

  // 获取DOM元素
  const hourCountdownElement = document.getElementById('hour-countdown');
  const priceCountdownElement = document.getElementById('price-countdown');
  const priceRefreshElement = document.getElementById('price-refresh');
  const currentHourDisplay = document.getElementById('current-hour-display');

  // 官方刷新机制
  const HOUR_DURATION = 150; // 每个时辰150秒（2分30秒）
  const PRICE_REFRESH_DURATION = 600; // 商品刷新600秒（10分钟）

  // 初始化时间
  let currentHourIndex = 7; // 默认未时（索引7）
  let hourTimer = HOUR_DURATION;
  let priceTimer = PRICE_REFRESH_DURATION;

  // 根据当前时间计算倒计时
  function calculateTimers() {
    const now = new Date();
    const minutes = now.getMinutes();
    const seconds = now.getSeconds();

    // 计算商品刷新倒计时（每10分钟刷新）
    const totalSeconds = minutes * 60 + seconds;
    priceTimer = PRICE_REFRESH_DURATION - (totalSeconds % PRICE_REFRESH_DURATION);

    // 计算时辰倒计时（每2分30秒一个时辰）
    hourTimer = HOUR_DURATION - (totalSeconds % HOUR_DURATION);

    // 计算当前时辰索引
    currentHourIndex = Math.floor(totalSeconds / HOUR_DURATION) % 12;
  }

  // 更新倒计时显示
  function updateTimers() {
    // 更新时辰倒计时
    hourCountdownElement.textContent = `${hourTimer}秒`;

    // 更新商品刷新倒计时
    priceCountdownElement.textContent = `${priceTimer}秒`;
    priceRefreshElement.textContent = priceTimer;

    // 更新当前时辰显示
    currentHourDisplay.textContent = hourNames[currentHourIndex] + "时";
  }

  // 更新罗盘位置
  function updateCompass() {
    // 计算当前时辰的角度（每个时辰30度）
    const hourAngle = currentHourIndex * 30;

    // 设置当前时辰标记位置
    document.querySelector('.current-hour-mark').style.transform =
            `rotate(${hourAngle}deg) translateX(-50%) translateY(-10px)`;
    document.querySelector('.current-hour-dot').style.transform =
            `rotate(${hourAngle}deg) translateX(-50%) translateY(25px)`;
  }

  // 主计时器函数
  function runTimers() {
    calculateTimers();
    updateTimers();
    updateCompass();

    // 每秒更新一次
    setTimeout(runTimers, 1000);
  }

  // 初始化
  calculateTimers();
  updateTimers();
  updateCompass();
  runTimers();

  // 按钮功能
  const cancelBtn = document.querySelector('.cancel-alert-btn');
  const incenseBtn = document.querySelector('.incense-btn');

  cancelBtn.addEventListener('click', function() {
    alert('提醒已取消！');
  });

  incenseBtn.addEventListener('click', function() {
    alert('摄妖香提醒已开启！30分钟后将会收到提醒');
  });

  // 更新当前时间显示
  function updateCurrentTime() {
    const now = new Date();
    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    document.querySelector('.current-time').textContent = `${hours}:${minutes} 56A 5G 47`;
  }

  // 路线筛选功能
  function showRoute(type) {
    const recommendations = document.querySelectorAll('.recommendation');
    
    recommendations.forEach(rec => {
      const routeType = rec.getAttribute('data-route-type');
      
      if (type === 'all' || routeType === type || routeType === 'tips') {
        rec.style.display = 'block';
      } else {
        rec.style.display = 'none';
      }
    });
    
    // 更新按钮状态
    const buttons = document.querySelectorAll('[onclick^="showRoute"]');
    buttons.forEach(btn => {
      btn.style.opacity = '0.7';
      btn.style.transform = 'scale(0.95)';
    });
    
    // 高亮当前选中的按钮
    const currentBtn = document.querySelector(`[onclick="showRoute('${type}')"]`);
    if (currentBtn) {
      currentBtn.style.opacity = '1';
      currentBtn.style.transform = 'scale(1.05)';
    }
  }

     // 紧凑模式切换
   function toggleCompact() {
     const body = document.body;
     const toggle = document.querySelector('.compact-toggle');
     
     if (body.classList.contains('compact-mode')) {
       body.classList.remove('compact-mode');
       toggle.textContent = '📱';
       toggle.title = '切换到紧凑模式';
     } else {
       body.classList.add('compact-mode');
       toggle.textContent = '🖥️';
       toggle.title = '切换到完整模式';
     }
   }

   // 城市筛选功能
   function filterCity(cityName) {
     const cityCards = document.querySelectorAll('.city-card');
     const filterButtons = document.querySelectorAll('.city-filter-btn');
     
     // 更新按钮状态
     filterButtons.forEach(btn => {
       btn.classList.remove('active');
     });
     
     // 激活当前选中的按钮
     const currentBtn = document.querySelector(`[onclick="filterCity('${cityName}')"]`);
     if (currentBtn) {
       currentBtn.classList.add('active');
     }
     
     // 筛选城市卡片
     cityCards.forEach(card => {
       if (cityName === 'all' || card.getAttribute('data-city') === cityName) {
         card.classList.remove('hidden');
       } else {
         card.classList.add('hidden');
       }
     });
     
     // 显示筛选提示
    //  if (cityName !== 'all') {
    //    showNotification(`已筛选: ${cityName}`);
    //  }
   }

  // 交易记录功能
  let tradeItems = [];
  let tradeRecordVisible = false;

  function toggleTradeRecord() {
    const record = document.getElementById('tradeRecord');
    const toggle = document.querySelector('.trade-toggle');
    
    if (tradeRecordVisible) {
      record.classList.remove('show');
      toggle.classList.remove('active');
      toggle.title = '显示交易记录';
    } else {
      record.classList.add('show');
      toggle.classList.add('active');
      toggle.title = '隐藏交易记录';
    }
    tradeRecordVisible = !tradeRecordVisible;
  }

  // 一键记录商品
  function recordItem(itemName, price, location) {
    // 提示玩家输入真实的买入价格
    const realPrice = prompt(`请输入${itemName}的真实买入价格（参考价格：${price}银两）:`);
    if (!realPrice || isNaN(realPrice)) return;
    
    const tradeItem = {
      id: Date.now(),
      item: itemName,
      price: parseInt(realPrice),
      location: location,
      time: new Date().toLocaleTimeString()
    };
    
    tradeItems.push(tradeItem);
    updateTradeDisplay();
    saveTradeItems();
    
    // 显示成功提示
    showNotification(`已记录: ${itemName} (${location}) - ${realPrice}银两`);
    
    // 自动显示交易记录面板
    if (!tradeRecordVisible) {
      toggleTradeRecord();
    }
  }

  function removeTradeItem(id) {
    const item = tradeItems.find(item => item.id === id);
    tradeItems = tradeItems.filter(item => item.id !== id);
    updateTradeDisplay();
    saveTradeItems();
    if (item) {
      showNotification(`已删除: ${item.item}`);
    }
  }

  function clearAllTrades() {
    if (confirm('确定要清空所有交易记录吗？')) {
      tradeItems = [];
      updateTradeDisplay();
      saveTradeItems();
      showNotification('已清空所有交易记录');
    }
  }

  function updateTradeDisplay() {
    const container = document.getElementById('tradeItems');
    container.innerHTML = '';
    
    if (tradeItems.length === 0) {
      container.innerHTML = '<div style="color: #a0b0d0; text-align: center; font-size: 11px; padding: 10px;">暂无交易记录</div>';
      return;
    }
    
    tradeItems.forEach(item => {
      const itemDiv = document.createElement('div');
      itemDiv.className = 'trade-item';
      itemDiv.innerHTML = `
        <div class="item-info">${item.item} (${item.location})</div>
        <div class="price-info">买入: ${item.price} 银两</div>
        <div class="time-info">${item.time}</div>
        <button onclick="removeTradeItem(${item.id})" style="background: #ff6666; color: white; border: none; border-radius: 3px; padding: 2px 6px; font-size: 10px; cursor: pointer; margin-top: 3px;">删除</button>
      `;
      container.appendChild(itemDiv);
    });
  }

  function saveTradeItems() {
    localStorage.setItem('tradeItems', JSON.stringify(tradeItems));
  }

  function loadTradeItems() {
    const saved = localStorage.getItem('tradeItems');
    if (saved) {
      tradeItems = JSON.parse(saved);
      updateTradeDisplay();
    }
  }

  // 显示通知
  function showNotification(message) {
    // 创建通知元素
    const notification = document.createElement('div');
    notification.style.cssText = `
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(76, 175, 80, 0.9);
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 14px;
      z-index: 10000;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      animation: fadeInOut 2s ease-in-out;
    `;
    notification.textContent = message;
    
    // 添加动画样式
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeInOut {
        0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
      }
    `;
    document.head.appendChild(style);
    
    document.body.appendChild(notification);
    
    // 2秒后自动移除
    setTimeout(() => {
      document.body.removeChild(notification);
    }, 2000);
  }

  // 初始化时间并每分钟更新
  updateCurrentTime();
  setInterval(updateCurrentTime, 60000);
  
  // 默认显示全部路线
  showRoute('all');
  
  // 初始化交易记录
  loadTradeItems();

  // 键盘快捷键
  document.addEventListener('keydown', function(e) {
    // Ctrl + 1: 切换紧凑模式
    if (e.ctrlKey && e.key === '1') {
      e.preventDefault();
      toggleCompact();
    }
    // Ctrl + 2: 显示新手路线
    if (e.ctrlKey && e.key === '2') {
      e.preventDefault();
      showRoute('newbie');
    }
    // Ctrl + 3: 显示进阶路线
    if (e.ctrlKey && e.key === '3') {
      e.preventDefault();
      showRoute('intermediate');
    }
    // Ctrl + 4: 显示高级路线
    if (e.ctrlKey && e.key === '4') {
      e.preventDefault();
      showRoute('advanced');
    }
    // Ctrl + 0: 显示全部路线
    if (e.ctrlKey && e.key === '0') {
      e.preventDefault();
      showRoute('all');
    }
    // Ctrl + T: 切换交易记录
    if (e.ctrlKey && e.key === 't') {
      e.preventDefault();
      toggleTradeRecord();
    }
    
         // Ctrl + C: 清空交易记录
     if (e.ctrlKey && e.key === 'c') {
       e.preventDefault();
       clearAllTrades();
     }
     // Ctrl + 5: 显示全部城市
     if (e.ctrlKey && e.key === '5') {
       e.preventDefault();
       filterCity('all');
     }
     // Ctrl + 6: 筛选地府
     if (e.ctrlKey && e.key === '6') {
       e.preventDefault();
       filterCity('地府');
     }
     // Ctrl + 7: 筛选长安
     if (e.ctrlKey && e.key === '7') {
       e.preventDefault();
       filterCity('长安');
     }
     // Ctrl + 8: 筛选傲来
     if (e.ctrlKey && e.key === '8') {
       e.preventDefault();
       filterCity('傲来');
     }
     // Ctrl + 9: 筛选长寿
     if (e.ctrlKey && e.key === '9') {
       e.preventDefault();
       filterCity('长寿');
     }
     // Ctrl + 0: 筛选北俱
     if (e.ctrlKey && e.key === '0') {
       e.preventDefault();
       filterCity('北俱');
     }
  });
</script>
</body>
</html>
